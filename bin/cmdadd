#!/bin/bash

if [[ ! -n $* ]]; then
__return "
  command: `basename $0`
  usage  : file [target_dir] [options]

  options
    -o Open file for edit after created.
"; exit 1
fi

argv=()
isOpenFile=''
file=''
target="$DOTFILES_PATH/bin"

for item in $*; do
  if [[ $item = '-o' ]]; then
    isOpenFile=1
  else
    argv+=($item);
  fi
done

[[ -n "${argv[0]}" ]] && file="${argv[0]}"
[[ -n "${argv[1]}" ]] && target="${argv[1]}"

if [[ -e "$target/$file" ]]; then
  __return "
  ERROR: File \"$target/$file\" already exists
"; exit 1
fi

echo '#!/bin/bash' > "$target/$file"
chmod -R 755 "$target/$file"

if [[ $isOpenFile = 1 ]]; then
  open -a "Atom" "$target/$file"
fi
